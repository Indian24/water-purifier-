You are an expert full-stack engineer and DevOps automation agent. Produce a complete, runnable repository that implements a production-minded user registration → persistence → auto-login → authentication system with frontend, backend, database, tests, and docs. Follow these exact functional, API, security, and deliverable requirements. Output the repository as files with code, config, tests, and a README explaining how to run everything locally (with Docker Compose) and how to deploy.

--- PROJECT OVERVIEW & MUST-HAVE BEHAVIOR ---
Goal:
- A user registers via a frontend form (Full name, Phone (required), Email (optional), Password, Confirm Password).
- Phone is required and unique. Email is optional and unique if provided.
- After successful registration the user must be auto-logged in (server issues auth) and redirected to a protected dashboard.
- Login must accept either phone + password or email + password (email only works if the user provided it).
- Authentication must persist across page reloads and be revocable (cookie-based JWT with server refresh or refresh-token strategy).
- Use user.id (UUID) as the canonical FK for all future tables.

Stack (default — implement unless user requests otherwise):
- Backend: Node.js (>=18) + Express
- Database: PostgreSQL
- Frontend: React (Vite recommended) — minimal, clean UI matching register/login flow
- Migrations: SQL files or a migration tool (Knex, Sequelize, or node-pg-migrate)
- Testing: Jest + Supertest for backend; Vitest/React Testing Library for frontend
- Containerization: Docker + docker-compose to run app + db + (optional) admin tool (pgAdmin)
- API spec: OpenAPI (swagger.yaml)

--- DATABASE SCHEMA (REQUIRED) ---
Provide SQL migration file(s) that create:
- `users` table with columns:
  - `id UUID PRIMARY KEY DEFAULT gen_random_uuid()`
  - `phone VARCHAR(25) NOT NULL UNIQUE` — normalized E.164
  - `phone_verified BOOLEAN NOT NULL DEFAULT false`
  - `email VARCHAR(255) UNIQUE` — nullable
  - `email_verified BOOLEAN NOT NULL DEFAULT false`
  - `password_hash TEXT NOT NULL`
  - `full_name VARCHAR(255)`
  - `created_at TIMESTAMP WITH TIME ZONE DEFAULT now()`
  - `updated_at TIMESTAMP WITH TIME ZONE DEFAULT now()`
- Add indexes on `phone` and `email`.

--- BACKEND REQUIREMENTS ---
Implement an Express server with these endpoints and behaviors:

1) `POST /api/auth/register`
- Request JSON: `{ "full_name","phone","email" (optional),"password","confirm_password" }`
- Server must:
  - Normalize phone to E.164 using libphonenumber (default country = IN).
  - Validate inputs (phone required, password >= 8 chars, matching confirm_password, email RFC check if provided).
  - Reject duplicate phone/email with 409 and clear error messages.
  - Hash password with bcrypt (cost >= 12) or Argon2.
  - Insert user and return 201 with minimal user object (`id, phone, email, full_name, created_at`).
  - Immediately issue auth (JWT) and set it as an `HttpOnly` cookie (Secure in production). This achieves auto-login.
  - Do not return password or hash.
  - For dev mode, log OTPs/verification tokens to console (do NOT send real SMS in demo).
  - Keep response time reasonable and do not leak whether phone exists beyond the 409 code.

2) `POST /api/auth/login`
- Accept `{ "identifier", "password" }` where identifier is phone or email.
- Normalize identifier to phone if numeric; otherwise treat as email.
- Validate and compare password using bcrypt.
- On success: issue JWT (short expiry) and (optionally) a refresh token stored server-side; set cookies and return user object.
- On failure: return `401 Invalid credentials` (do not reveal which field caused failure).

3) `GET /api/auth/me`
- Auth-protected endpoint using cookie or Authorization header bearer token.
- Returns current user profile without password.

4) `POST /api/auth/logout`
- Clear auth cookie (and invalidate refresh token if used).

5) Password reset / verification endpoints (minimal working flow):
- `POST /api/auth/request-password-reset` — accept phone or email; send token (dev: log to console).
- `POST /api/auth/reset-password` — accept token + new password; perform update.
- `POST /api/auth/verify-phone` & `POST /api/auth/verify-email` — verification flows (dev: logged token).

Security rules (must implement):
- Hash passwords with bcrypt (recommend cost 12) or Argon2; never store plaintext.
- Use JWT signed with `JWT_SECRET`; short access expiry (e.g., 15m). Implement refresh token (optional but preferred) with DB storage for revocation.
- Set cookies: `HttpOnly`, `SameSite=Lax` (or Strict), `Secure` in production.
- Rate-limit auth endpoints (express-rate-limit); account lockout after N failed attempts (configurable).
- Input sanitization and parameterized queries (no SQL concatenation).
- Do not log sensitive data (passwords, tokens).
- Use environment variables for secrets; provide `.env.example` (do not hardcode secrets).

Auth middleware:
- Validate cookie or Bearer token; set `req.userId` and fetch user for protected routes.

--- FRONTEND REQUIREMENTS ---
Implement a small React app (Vite OK) with:
- Pages/components:
  - `/register` — form matching fields in screenshot (Full name, Phone required, Email optional, Password, Confirm Password).
  - `/login` — identifier + password.
  - `/dashboard` — protected, fetches `/api/auth/me` and displays user basic info.
- Client behavior:
  - Client-side validation: phone required, normalize phone on blur using `libphonenumber-js`, password confirmation checked locally.
  - Disable submit while validating or awaiting response.
  - On successful register: backend sets cookie; front-end auto-redirects to `/dashboard`.
  - Use `fetch` with `credentials: 'include'` to send/receive cookies.
  - Display server errors clearly (e.g., duplicate phone/email).
  - Do not store JWT in localStorage; rely on httpOnly cookie.

--- INFRA & RUNNING ---
- Provide `docker-compose.yml` that spins up:
  - `db` (postgres image), initialized with migrations
  - `backend` (node app)
  - `frontend` (dev server)
  - Optional `pgadmin` or admin UI
- Provide `Makefile` or npm scripts to run locally without Docker as well.
- Provide `.env.example` with: `DATABASE_URL`, `JWT_SECRET`, `PORT`, `BCRYPT_ROUNDS`, `FRONTEND_ORIGIN`, `NODE_ENV`.

--- TESTS & QA ---
- Backend unit & integration tests (Jest + Supertest) covering:
  - register success
  - register duplicate phone
  - register duplicate email
  - login by phone success
  - login by email success (if email present)
  - login fail incorrect password
  - `/me` protected behavior
- Frontend tests (unit or e2e minimal) ensuring:
  - client validation prevents bad submit
  - register flow triggers redirect to dashboard (mocked)
- Provide a `test:ci` script that runs tests in CI.

--- DOCS & DELIVERABLES (exact) ---
Produce these repository files and content:
1. `README.md` — setup, run with Docker Compose, run locally, env variables, endpoints, example curl commands, security notes.
2. `docker-compose.yml`
3. `backend/` folder:
   - `package.json` + `package-lock.json`
   - `src/server.js` (or `index.js`) with all endpoints and middleware
   - `src/db/migrations/0001_create_users.sql`
   - `src/routes/auth.js`, `src/middleware/auth.js`, `src/utils/phone.js`
   - `src/tests/*.test.js` (Jest + supertest)
   - `src/openapi.yaml` describing endpoints
   - `.env.example`
4. `frontend/` folder:
   - `package.json`
   - Vite React app with `src/pages/Register.jsx`, `Login.jsx`, `Dashboard.jsx`, an `api.js` helper that calls backend with `credentials: 'include'`.
   - Minimal CSS to match screenshot layout.
5. `scripts/` to run migrations and seed a demo user (optional).
6. `postman_collection.json` or exported curl examples.
7. `CI` config file for GitHub Actions to run `npm test` for both frontend and backend.
8. `SECURITY.md` with checklist (cookie settings, rotate secrets, production tips).

--- ACCEPTANCE CRITERIA (automatic tests & manual checks) ---
The produced project must pass these checks:
- `docker-compose up` brings up all services; migrations run; app accessible.
- Register flow: POST register with phone only → 201, cookie set, and visiting `/dashboard` shows logged-in user.
- Register with phone+email → success.
- Duplicate phone/email returns 409.
- Login with phone+password works.
- Login with email+password works (if email exists).
- `/api/auth/me` returns 401 when not authenticated and 200 when authenticated via cookie.

--- CODING STYLE & DELIVERY ---
- Use async/await and ES modules (or CommonJS consistently).
- Use parameterized SQL queries or an ORM — avoid raw string concatenation.
- Make provider-specific integrations (SMS/email) pluggable — default to console/logging for dev.
- Keep code well-organized and documented.
- At the end, return a ZIP or a file listing of the repository with the actual file contents inline (or point to a Git repo if you can create one).
- Provide exact commands to run locally and in Docker.

--- EXTRA NOTES FOR THE AGENT ---
- Do not fabricate real secret keys or publish them.
- For phone normalization assume India as default but make it configurable.
- Use `users.id` (UUID) as primary key and recommend using `id` for FK elsewhere.
- Log OTPs only in dev mode and ensure OTPs are not used in production logs.

--- FINAL OUTPUT FORMAT (important) ---
When finished, return:
1. A top-level listing of files created.
2. The full content of key files inline in the response (README, docker-compose.yml, backend/src/server.js, migration SQL, frontend/src/pages/Register.jsx).
3. A `README.md` with exact commands to run and test.
4. Optionally a downloadable link or instructions to `git clone` if you publish to a repo.

--- END ---
